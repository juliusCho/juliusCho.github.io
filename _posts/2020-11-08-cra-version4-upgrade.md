---
layout: post
title:  "CRA 버전 4 업그레이드"
categories: [ Jekyll, tutorial ]
featured: true
beforetoc: "** 해당 포스팅은 제가 찾은 정보들을 바탕으로 작성된 것이며, 정보가 빈약하거나 오류가 있을 수 있습니다. 댓글로 지적 & 수정요청 해주시면 너무나 감사하겠습니다!"
---
`기존 Create React App 패키지 버전 3에서 4로 업그레이드할 경우입니다.`

Create-React-App 패키지는 리엑트 프로젝트를 처음 생성&구성하기에 너무도 간편한 툴입니다.
명령어 한번으로 리엑트 프로젝트가 필요할 만한 기본 라이브러리들을 모두 완벽히 호환되는 버전으로 딱 세팅해주니
최근의 웬만한 리액트 개발자들은 이 패키지를 접해보지 않을 수 없습니다.

이렇게 리액트 개발의 필수품 중 하나가 된 CRA(Create-React-App)가
바로 지난달 23일(2020-10-23)에 메이저 버전 업데이트가 되었는데요.
이번 버전에서는 어떤 최신 라이브러리들을 기본으로 제공하는지,
그리고 기존 CRA 버전 3로 생성된 프로젝트를 버전업 하는 방법을 살펴 보도록 하겠습니다. 

## 1. 기본 제공 메이저 라이브러리
#### 리액트 17
사실 이번 17버전의 리액트는 기존 16버전대랑 비교해 별 차이가 없다고는 합니다만,
가장 눈에 띄는 변화라면, jsx 스크립트 상단에 꼭 "import React from 'react'"를 쓰지 않아도 된다는 것이라네요(아직 타입스크립트는 최신 베타버전(4.10-beta)에서밖에 지원이 안된답니다ㅠ).

#### Fast Refresh
서버 사이드 렌더링이 필요한 리액트 프로젝트들이 거의 표준으로 채택하고 있는 NextJS에서 기존에 제공했던
Fast Refresh가 이번 CRA에서도 제공된다고 합니다. 이전 버전에서 제공하던 React Hot Loader와 같이
리액트 컴포넌트 스크립트 변경 시에 자동으로 브라우저 새로고침 기능을 지원하는 라이브러리인데요.
Hot Loader보다 더 빠르면서 동시에 기존 컴포넌트 내 상태를 유지한채로 브라우저를 리로딩 시키는 기능이 있다고 합니다.

#### 타입스크립트 4+, ESLint 7, Jest 26
점차 프론트엔드에서 필수가 되어가고 있는 타입스크립트의 가장 최신 메이저 버전인 4가 제공됩니다.
저도 아직 4버전의 타입스크립트에 대해 조사하지 못해 어떤 점이 바뀌었는지는 알지 못하는데요.. 타입 체크에 대한 정확도가 높아졌다는 정도만 소문으로(?) 들었네요.

또한 코드 품질과 포멧팅 관리 설정 및 체크를 하는 툴인 ESLint는, 현존하는 모든 Linter 툴 중
가장 널리 사용되고 있으며 이제는 사실상 자바스크립트 개발의 필수품이 되어버렸습니다.
이 툴의 최신버전 또한 지원하고 있구요.

프론트엔드 스크립트의 단위 테스트 도구 중, 가장 대표적으로 사용되는 Jest 라이브러리 또한 최신버전이 지원됩니다.

#### Workbox 지원
Workbox란, 구글에서 지원하는 progressive web app을 위한 라이브러리이며
프로그래시브 웹앱이 오프라인에서도 동작할 수 있도록 각종 기능을 제공해 줍니다.

#### Web Vitals 지원
Web Vitals란, 구글 크롬 브라우에서 지원하는 각종 웹 페이지 성능 분석 데이터를 바탕으로
에플리케이션 프론트엔드의 성능 분석을 더 쉽게 가능하게끔 도와주는 라이브러리 입니다.

웹 페이지가 접근 요청을 받은 후, 페이지가 반응하기까지의 시간을 측정한 First Input Delay(FID),
웹 페이지가 접근 요청을 받은 후, 해당 페이지 내 가장 큰 용량의 컨텐츠가 로딩완료되는 시점까지의 시간을 측정한 Largest Contentful Paing(LCP),
그리고 페이지 로딩 완료 후에 페이지 내 동적 레이아웃 변경 빈도를 측정한 Cumulative Layout Shift(CLS) 등의
중요한 지표분석을 쉽게 도와준다고 합니다.

## 2. CRA 4버전 업그레이드
1. 터미널에서 업그레이드 적용할 프로젝트의 Root 경로로 이동합니다.
1. npm 또는 yarn을 사용해 다음의 커맨드를 실행하여 CRA버전을 업그레이드 합니다 :
```
[npm/yarn] add --exact react-scripts@4.0.0
```
이것으로 업그레이드가 끝이지만, typescript를 연동하여 사용할 시에 다음과 같은 type 오류가 발생할 수 있습니다(기존 typescript 3버전대를 사용한 경우) :
`TypeError: Cannot add property noFallthroughCasesInSwitch, object is not extensible`

해결방법: 프로젝트 루트 경로의 tsconfig.json 파일을 열어, "compilerOptions" 내부 속성에 다음을 추가합니다 :
```
"noFallthroughCasesInSwitch": true
```

`** 그 외에 이전 버전의 esList와 Jest 사용 시에도 호환이 되지 않는 부분들이 존재한다고 하니,
이전 버전을 사용 중에 있다면, package.json 내에서 해당 라이브러리들의 패키지를 최신으로 맞춰주신 후
npm/yarn install을 진행하시고, 내부 스크립트의 변경도 필요에 의해 맞춰주는 작업을 하셔야 합니다.`
